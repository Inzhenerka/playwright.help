---
id: test-reporters
title: "Репортеры"
---
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import HTMLCard from '@site/src/components/HTMLCard';

## Введение

Playwright Test поставляется с несколькими встроенными репортерами для различных нужд и возможностью предоставления пользовательских репортеров. Самый простой способ попробовать встроенные репортеры — передать опцию `--reporter` [в командной строке](./test-cli.mdx).

```bash
npx playwright test --reporter=line
```

Для большего контроля вы можете указать репортеры программно в [файле конфигурации](./test-configuration.mdx).

```js title="playwright.config.ts"
import { defineConfig } from '@playwright/test';

export default defineConfig({
  reporter: 'line',
});
```

### Несколько репортеров

Вы можете использовать несколько репортеров одновременно. Например, вы можете использовать `'list'` для красивого вывода в терминале и `'json'` для получения подробного json-файла с результатами тестов.

```js title="playwright.config.ts"
import { defineConfig } from '@playwright/test';

export default defineConfig({
  reporter: [
    ['list'],
    ['json', { outputFile: 'test-results.json' }]
  ],
});
```

### Репортеры в CI

Вы можете использовать разные репортеры локально и в CI. Например, использование краткого репортера `'dot'` позволяет избежать избыточного вывода. Это значение по умолчанию в CI.

```js title="playwright.config.ts"
import { defineConfig } from '@playwright/test';

export default defineConfig({
  // Краткий 'dot' для CI, по умолчанию 'list' при локальном запуске
  reporter: process.env.CI ? 'dot' : 'list',
});
```

## Встроенные репортеры

Все встроенные репортеры показывают подробную информацию о сбоях и в основном различаются по уровню подробности для успешных запусков.

### Репортер списка

Репортер списка является значением по умолчанию (за исключением CI, где по умолчанию используется репортер `dot`). Он выводит строку для каждого теста, который выполняется.

```bash
npx playwright test --reporter=list
```

```js title="playwright.config.ts"
import { defineConfig } from '@playwright/test';

export default defineConfig({
  reporter: 'list',
});
```

Вот пример вывода в середине выполнения теста. Сбои будут перечислены в конце.

```bash
npx playwright test --reporter=list
Running 124 tests using 6 workers

 1  ✓ should access error in env (438ms)
 2  ✓ handle long test names (515ms)
 3  x 1) render expected (691ms)
 4  ✓ should timeout (932ms)
 5    should repeat each:
 6  ✓ should respect enclosing .gitignore (569ms)
 7    should teardown env after timeout:
 8    should respect excluded tests:
 9  ✓ should handle env beforeEach error (638ms)
10    should respect enclosing .gitignore:
```

Вы можете включить отображение шагов, передав следующую опцию конфигурации:

```js title="playwright.config.ts"
import { defineConfig } from '@playwright/test';

export default defineConfig({
  reporter: [['list', { printSteps: true }]],
});
```

Репортер списка поддерживает следующие параметры конфигурации и переменные окружения:

| Имя переменной окружения | Параметр конфигурации репортера | Описание | По умолчанию
|---|---|---|---|
| `PLAYWRIGHT_LIST_PRINT_STEPS` | `printSteps` | Указывает, следует ли выводить каждый шаг на отдельной строке. | `false`
| `PLAYWRIGHT_FORCE_TTY` | | Указывает, следует ли производить вывод, подходящий для живого терминала. Если указано число, оно также будет использоваться как ширина терминала. | `true`, когда терминал находится в режиме TTY, `false` в противном случае.
| `FORCE_COLOR` | | Указывает, следует ли производить цветной вывод. | `true`, когда терминал находится в режиме TTY, `false` в противном случае.

### Линейный репортер

Линейный репортер более лаконичен, чем репортер списка. Он использует одну строку для отчета о последнем завершенном тесте и выводит сбои по мере их возникновения. Линейный репортер полезен для больших наборов тестов, так как показывает прогресс, но не засоряет вывод, перечисляя все тесты.

```bash
npx playwright test --reporter=line
```

```js title="playwright.config.ts"
import { defineConfig } from '@playwright/test';

export default defineConfig({
  reporter: 'line',
});
```

Вот пример вывода в середине выполнения теста. Сбои сообщаются в строке.

```bash
npx playwright test --reporter=line
Running 124 tests using 6 workers
  1) dot-reporter.spec.ts:20:1 › render expected ===================================================

    Error: expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 0

[23/124] gitignore.spec.ts - should respect nested .gitignore
```

Линейный отчет поддерживает следующие параметры конфигурации и переменные окружения:

| Имя переменной окружения | Параметр конфигурации репортера | Описание | По умолчанию
|---|---|---|---|
| `PLAYWRIGHT_FORCE_TTY` | | Указывает, следует ли производить вывод, подходящий для живого терминала. Если указано число, оно также будет использоваться как ширина терминала. | `true`, когда терминал находится в режиме TTY, `false` в противном случае.
| `FORCE_COLOR` | | Указывает, следует ли производить цветной вывод. | `true`, когда терминал находится в режиме TTY, `false` в противном случае.

### Точечный репортер

Точечный репортер очень лаконичен — он производит только один символ за успешный тест. Это значение по умолчанию в CI и полезно, когда вы не хотите много вывода.

```bash
npx playwright test --reporter=dot
```

```js title="playwright.config.ts"
import { defineConfig } from '@playwright/test';

export default defineConfig({
  reporter: 'dot',
});
```

Вот пример вывода в середине выполнения теста. Сбои будут перечислены в конце.

```bash
npx playwright test --reporter=dot
Running 124 tests using 6 workers
······F·············································
```

Один символ отображается для каждого теста, который был выполнен, указывая его статус:

| Символ | Описание
|---|---|
| `·` | Пройден
| `F` | Провален
| `×` | Провален или истек по времени — и будет повторен
| `±` | Пройден при повторе (неустойчивый)
| `T` | Истек по времени
| `°` | Пропущен

Точечный отчет поддерживает следующие параметры конфигурации и переменные окружения:

| Имя переменной окружения | Параметр конфигурации репортера | Описание | По умолчанию
|---|---|---|---|
| `PLAYWRIGHT_FORCE_TTY` | | Указывает, следует ли производить вывод, подходящий для живого терминала. Если указано число, оно также будет использоваться как ширина терминала. | `true`, когда терминал находится в режиме TTY, `false` в противном случае.
| `FORCE_COLOR` | | Указывает, следует ли производить цветной вывод. | `true`, когда терминал находится в режиме TTY, `false` в противном случае.

### HTML репортер

HTML репортер создает самодостаточную папку, которая содержит отчет о выполнении теста, который можно обслуживать как веб-страницу.

```bash
npx playwright test --reporter=html
```

По умолчанию HTML отчет открывается автоматически, если некоторые тесты провалились. Вы можете контролировать это поведение с помощью свойства `open` в конфигурации Playwright или переменной окружения `PLAYWRIGHT_HTML_OPEN`. Возможные значения для этого свойства: `always`, `never` и `on-failure` (по умолчанию).

Вы также можете настроить `host` и `port`, которые используются для обслуживания HTML отчета.

```js title="playwright.config.ts"
import { defineConfig } from '@playwright/test';

export default defineConfig({
  reporter: [['html', { open: 'never' }]],
});
```

По умолчанию отчет записывается в папку `playwright-report` в текущем рабочем каталоге. Вы можете переопределить это местоположение, используя переменную окружения `PLAYWRIGHT_HTML_OUTPUT_DIR` или конфигурацию репортера.

В файле конфигурации передайте параметры напрямую:

```js title="playwright.config.ts"
import { defineConfig } from '@playwright/test';

export default defineConfig({
  reporter: [['html', { outputFolder: 'my-report' }]],
});
```

Если вы загружаете вложения из папки данных в другое место, вы можете использовать параметр `attachmentsBaseURL`, чтобы указать HTML отчету, где их искать.

```js title="playwright.config.ts"
import { defineConfig } from '@playwright/test';

export default defineConfig({
  reporter: [['html', { attachmentsBaseURL: 'https://external-storage.com/' }]],
});
```

Быстрый способ открыть отчет последнего выполнения теста:

```bash
npx playwright show-report
```

Или, если есть имя пользовательской папки:

```bash
npx playwright show-report my-report
```

HTML отчет поддерживает следующие параметры конфигурации и переменные окружения:

| Имя переменной окружения | Параметр конфигурации репортера | Описание | По умолчанию
|---|---|---|---|
| `PLAYWRIGHT_HTML_OUTPUT_DIR` | `outputFolder` | Директория для сохранения отчета. | `playwright-report`
| `PLAYWRIGHT_HTML_OPEN` | `open` | Когда открывать HTML отчет в браузере, одно из `'always'`, `'never'` или `'on-failure'` | `'on-failure'`
| `PLAYWRIGHT_HTML_HOST` | `host` | Когда отчет открывается в браузере, он будет обслуживаться с привязкой к этому имени хоста. | `localhost`
| `PLAYWRIGHT_HTML_PORT` | `port` | Когда отчет открывается в браузере, он будет обслуживаться на этом порту. | `9323` или любой доступный порт, если `9323` недоступен.
| `PLAYWRIGHT_HTML_ATTACHMENTS_BASE_URL` | `attachmentsBaseURL` | Отдельное местоположение, куда загружаются вложения из подкаталога `data`. Необходимо только в том случае, если вы загружаете отчет и `data` отдельно в разные места. | `data/`

### Blob репортер

Blob отчеты содержат все детали о выполнении теста и могут быть использованы позже для создания любого другого отчета. Их основная функция — облегчить объединение отчетов из [шардированных тестов](./test-sharding.mdx).

```bash
npx playwright test --reporter=blob
```

По умолчанию отчет записывается в директорию `blob-report` в каталоге package.json или текущем рабочем каталоге (если файл package.json не найден). Имя файла отчета выглядит как `report-<hash>.zip` или `report-<hash>-<shard_number>.zip`, когда используется [шардинг](./test-sharding.mdx). Хэш — это необязательное значение, вычисляемое из `--grep`, `--grepInverted`, `--project` и фильтров файлов, переданных в качестве аргументов командной строки. Хэш гарантирует, что запуск Playwright с разными опциями командной строки будет производить разные, но стабильные между запусками имена отчетов. Имя выходного файла можно переопределить в файле конфигурации или передать как переменную окружения `'PLAYWRIGHT_BLOB_OUTPUT_FILE'`.

```js title="playwright.config.ts"
import { defineConfig } from '@playwright/test';

export default defineConfig({
  reporter: [['blob', { outputFile: `./blob-report/report-${os.platform()}.zip` }]],
});
```

Blob отчет поддерживает следующие параметры конфигурации и переменные окружения:

| Имя переменной окружения | Параметр конфигурации репортера | Описание | По умолчанию
|---|---|---|---|
| `PLAYWRIGHT_BLOB_OUTPUT_DIR` | `outputDir` | Директория для сохранения вывода. Существующее содержимое удаляется перед записью нового отчета. | `blob-report`
| `PLAYWRIGHT_BLOB_OUTPUT_NAME` | `fileName` | Имя файла отчета. | `report-<project>-<hash>-<shard_number>.zip`
| `PLAYWRIGHT_BLOB_OUTPUT_FILE` | `outputFile` | Полный путь к выходному файлу. Если определено, `outputDir` и `fileName` будут игнорироваться. | `undefined`

### JSON репортер

JSON репортер создает объект со всей информацией о выполнении теста.

Скорее всего, вы захотите записать JSON в файл. При запуске с `--reporter=json` используйте переменную окружения `PLAYWRIGHT_JSON_OUTPUT_NAME`:

<Tabs
  groupId="bash-flavor"
  defaultValue="bash"
  values={[
    {label: 'Bash', value: 'bash'},
    {label: 'PowerShell', value: 'powershell'},
    {label: 'Batch', value: 'batch'}
  ]
}>
<TabItem value="bash">

```bash
PLAYWRIGHT_JSON_OUTPUT_NAME=results.json npx playwright test --reporter=json
```

</TabItem>
<TabItem value="powershell">

```powershell
$env:PLAYWRIGHT_JSON_OUTPUT_NAME="results.json"
npx playwright test --reporter=json
```

</TabItem>
<TabItem value="batch">

```batch
set PLAYWRIGHT_JSON_OUTPUT_NAME=results.json
npx playwright test --reporter=json
```

</TabItem>
</Tabs>

В файле конфигурации передайте параметры напрямую:

```js title="playwright.config.ts"
import { defineConfig } from '@playwright/test';

export default defineConfig({
  reporter: [['json', { outputFile: 'results.json' }]],
});
```

JSON отчет поддерживает следующие параметры конфигурации и переменные окружения:

| Имя переменной окружения | Параметр конфигурации репортера | Описание | По умолчанию
|---|---|---|---|
| `PLAYWRIGHT_JSON_OUTPUT_DIR` | | Директория для сохранения выходного файла. Игнорируется, если указан выходной файл. | `cwd` или каталог конфигурации.
| `PLAYWRIGHT_JSON_OUTPUT_NAME` | `outputFile` | Базовое имя файла для вывода, относительно выходной директории. | JSON отчет выводится в stdout.
| `PLAYWRIGHT_JSON_OUTPUT_FILE` | `outputFile` | Полный путь к выходному файлу. Если определено, `PLAYWRIGHT_JSON_OUTPUT_DIR` и `PLAYWRIGHT_JSON_OUTPUT_NAME` будут игнорироваться. | JSON отчет выводится в stdout.

### JUnit репортер

JUnit репортер создает отчет в формате JUnit-style xml.

Скорее всего, вы захотите записать отчет в xml файл. При запуске с `--reporter=junit` используйте переменную окружения `PLAYWRIGHT_JUNIT_OUTPUT_NAME`:

<Tabs
  groupId="bash-flavor"
  defaultValue="bash"
  values={[
    {label: 'Bash', value: 'bash'},
    {label: 'PowerShell', value: 'powershell'},
    {label: 'Batch', value: 'batch'}
  ]
}>
<TabItem value="bash">

```bash
PLAYWRIGHT_JUNIT_OUTPUT_NAME=results.xml npx playwright test --reporter=junit
```

</TabItem>
<TabItem value="powershell">

```powershell
$env:PLAYWRIGHT_JUNIT_OUTPUT_NAME="results.xml"
npx playwright test --reporter=junit
```

</TabItem>
<TabItem value="batch">

```batch
set PLAYWRIGHT_JUNIT_OUTPUT_NAME=results.xml
npx playwright test --reporter=junit
```

</TabItem>
</Tabs>

В файле конфигурации передайте параметры напрямую:

```js title="playwright.config.ts"
import { defineConfig } from '@playwright/test';

export default defineConfig({
  reporter: [['junit', { outputFile: 'results.xml' }]],
});
```

JUnit отчет поддерживает следующие параметры конфигурации и переменные окружения:

| Имя переменной окружения | Параметр конфигурации репортера | Описание | По умолчанию
|---|---|---|---|
| `PLAYWRIGHT_JUNIT_OUTPUT_DIR` | | Директория для сохранения выходного файла. Игнорируется, если выходной файл не указан. | `cwd` или каталог конфигурации.
| `PLAYWRIGHT_JUNIT_OUTPUT_NAME` | `outputFile` | Базовое имя файла для вывода, относительно выходной директории. | JUnit отчет выводится в stdout.
| `PLAYWRIGHT_JUNIT_OUTPUT_FILE` | `outputFile` | Полный путь к выходному файлу. Если определено, `PLAYWRIGHT_JUNIT_OUTPUT_DIR` и `PLAYWRIGHT_JUNIT_OUTPUT_NAME` будут игнорироваться. | JUnit отчет выводится в stdout.
| `PLAYWRIGHT_JUNIT_STRIP_ANSI` | `stripANSIControlSequences` | Указывает, следует ли удалять управляющие последовательности ANSI из текста перед записью его в отчет. | По умолчанию текст вывода добавляется как есть.
| `PLAYWRIGHT_JUNIT_INCLUDE_PROJECT_IN_TEST_NAME` | `includeProjectInTestName` | Указывает, следует ли включать имя проекта Playwright в каждое тестовое имя в качестве префикса. | По умолчанию не включается.
| `PLAYWRIGHT_JUNIT_SUITE_ID` |  | Значение атрибута `id` в корневом элементе `<testsuites/>` отчета. | Пустая строка.
| `PLAYWRIGHT_JUNIT_SUITE_NAME` |  | Значение атрибута `name` в корневом элементе `<testsuites/>` отчета. | Пустая строка.

### Аннотации GitHub Actions

Вы можете использовать встроенный репортер `github`, чтобы получить автоматические аннотации ошибок при запуске в GitHub Actions.

Обратите внимание, что все остальные репортеры также работают в GitHub Actions, но не предоставляют аннотации. Также не рекомендуется использовать этот тип аннотаций, если вы запускаете свои тесты с помощью матричной стратегии, так как трассировки ошибок будут умножаться и затенять представление файлов GitHub.

```js title="playwright.config.ts"
import { defineConfig } from '@playwright/test';

export default defineConfig({
  // 'github' для GitHub Actions CI для генерации аннотаций, плюс краткий 'dot'
  // по умолчанию 'list' при локальном запуске
  reporter: process.env.CI ? 'github' : 'list',
});
```

## Пользовательские репортеры

Вы можете создать пользовательский репортер, реализовав класс с некоторыми методами репортера. Узнайте больше о [Reporter] API.

```js title="my-awesome-reporter.ts"
import type {
  FullConfig, FullResult, Reporter, Suite, TestCase, TestResult
} from '@playwright/test/reporter';

class MyReporter implements Reporter {
  onBegin(config: FullConfig, suite: Suite) {
    console.log(`Запуск с ${suite.allTests().length} тестами`);
  }

  onTestBegin(test: TestCase, result: TestResult) {
    console.log(`Запуск теста ${test.title}`);
  }

  onTestEnd(test: TestCase, result: TestResult) {
    console.log(`Завершение теста ${test.title}: ${result.status}`);
  }

  onEnd(result: FullResult) {
    console.log(`Завершение запуска: ${result.status}`);
  }
}

export default MyReporter;
```

Теперь используйте этот репортер с [testConfig.reporter](/api/class-testconfig.mdx#test-config-reporter).

```js title="playwright.config.ts"
import { defineConfig } from '@playwright/test';

export default defineConfig({
  reporter: './my-awesome-reporter.ts',
});
```

Или просто передайте путь к файлу репортера как опцию `--reporter` в командной строке:

```bash
npx playwright test --reporter="./myreporter/my-awesome-reporter.ts"
```

Вот краткий список реализаций открытых репортеров, которые вы можете изучить при написании собственного репортера:
* [Allure Reporter](https://github.com/allure-framework/allure-js/tree/main/packages/allure-playwright)
* [Github Actions Reporter](https://github.com/estruyf/playwright-github-actions-reporter)
* [Mail Reporter](https://github.com/estruyf/playwright-mail-reporter)
* [ReportPortal](https://github.com/reportportal/agent-js-playwright)
* [Monocart](https://github.com/cenfun/monocart-reporter)