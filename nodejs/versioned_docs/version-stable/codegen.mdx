---
id: codegen
title: "Генератор тестов"
---
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import HTMLCard from '@site/src/components/HTMLCard';

import LiteYouTube from '@site/src/components/LiteYouTube';

## Введение

Playwright предоставляет возможность генерировать тесты во время выполнения действий в браузере, что является отличным способом быстро начать тестирование. Playwright анализирует вашу страницу и определяет лучший локатор, придавая приоритет [локаторам по роли, тексту и тестовому идентификатору](./locators.mdx). Если генератор находит несколько элементов, соответствующих локатору, он улучшает локатор, чтобы сделать его более устойчивым и уникально идентифицировать целевой элемент.

## Генерация тестов в VS Code

Установите расширение для VS Code и генерируйте тесты прямо из VS Code. Расширение доступно в [VS Code Marketplace](https://marketplace.visualstudio.com/items?itemName=ms-playwright.playwright). Ознакомьтесь с нашим руководством по [началу работы с VS Code](./getting-started-vscode.mdx).

<LiteYouTube id="LM4yqrOzmFE" title="Генерация тестов Playwright в VS Code" />

### Запись нового теста

Чтобы записать тест, нажмите кнопку **Записать новый** в боковой панели тестирования. Это создаст файл `test-1.spec.ts` и откроет окно браузера.

<img width="1385" alt="record new in vs code" src="https://user-images.githubusercontent.com/13063165/220961665-615d0ab8-3f0b-439c-ad0b-0424d9aa154b.png" />

В браузере перейдите по URL, который вы хотите протестировать, и начните кликать, чтобы записать ваши действия.

![generating user actions](https://github.com/microsoft/playwright/assets/13063165/1d4c8f37-8325-4816-a665-d0e95e63f509)

Playwright запишет ваши действия и сгенерирует код теста прямо в VS Code. Вы также можете генерировать утверждения, выбрав одну из иконок на панели инструментов, а затем кликнув на элемент на странице для утверждения. Можно сгенерировать следующие утверждения:
* `'assert visibility'` для утверждения, что элемент видим
* `'assert text'` для утверждения, что элемент содержит определенный текст
* `'assert value'` для утверждения, что элемент имеет определенное значение

![generating assertions](https://github.com/microsoft/playwright/assets/13063165/d131eb35-b2ca-4bf4-a8ac-88b6e40dcf07)

Когда вы закончите запись, нажмите кнопку **отмена** или закройте окно браузера. Затем вы можете просмотреть файл `test-1.spec.ts` и при необходимости вручную улучшить его.

![code from a generated test](https://github.com/microsoft/playwright/assets/13063165/2ba4c212-4713-460a-b054-6dc6b67a9a7c)

### Запись с курсора

Чтобы записать с определенной точки в вашем тесте, переместите курсор в то место, где вы хотите записать дополнительные действия, а затем нажмите кнопку **Записать с курсора** в боковой панели тестирования. Если окно браузера еще не открыто, сначала запустите тест с установленным флажком 'Показать браузер', а затем нажмите кнопку **Записать с курсора**.

![record at cursor in vs code](https://github.com/microsoft/playwright/assets/13063165/77948ab8-92a2-435f-9833-0944da5ae664)

В окне браузера начните выполнять действия, которые вы хотите записать.

<img width="1394" alt="add feed the dog to todo app" src="https://user-images.githubusercontent.com/13063165/220960770-6435cec7-1723-42a8-8c1f-8244e2d800c7.png" />

В файле теста в VS Code вы увидите ваши новые сгенерированные действия, добавленные в тест в позиции курсора.

![code from a generated test](https://github.com/microsoft/playwright/assets/13063165/4f4bb34e-9cda-41fe-bf65-8d8016d84c7f)

### Генерация локаторов

Вы можете генерировать локаторы с помощью генератора тестов.
- Нажмите кнопку **Выбрать локатор** в боковой панели тестирования, а затем наведите курсор на элементы в окне браузера, чтобы увидеть [локатор](./locators.mdx), выделенный под каждым элементом.
- Нажмите на нужный элемент, и он появится в поле **Выбрать локатор** в VS Code.
- Нажмите <kbd>Enter</kbd> на клавиатуре, чтобы скопировать локатор в буфер обмена, а затем вставьте его в любом месте вашего кода. Или нажмите 'escape', если хотите отменить.

<img width="1641" alt="Pick locators in VS code" src="https://user-images.githubusercontent.com/13063165/220958368-95b03620-3c9b-40a8-be74-01c96ba03cad.png" />

## Генерация тестов с помощью Playwright Inspector

При выполнении команды `codegen` откроются два окна: окно браузера, в котором вы взаимодействуете с веб-сайтом, который хотите протестировать, и окно Playwright Inspector, где вы можете записывать свои тесты и затем копировать их в редактор.

### Запуск Codegen

Используйте команду `codegen`, чтобы запустить генератор тестов, за которой следует URL веб-сайта, для которого вы хотите сгенерировать тесты. URL является необязательным, и вы всегда можете запустить команду без него, а затем добавить URL непосредственно в окно браузера.

```bash
npx playwright codegen demo.playwright.dev/todomvc
```

### Запись теста

Запустите команду `codegen` и выполняйте действия в окне браузера. Playwright сгенерирует код для взаимодействий пользователя, который вы можете увидеть в окне Playwright Inspector. Когда вы закончите запись теста, остановите запись и нажмите кнопку **копировать**, чтобы скопировать сгенерированный тест в ваш редактор.

С помощью генератора тестов вы можете записывать:
* Действия, такие как клик или заполнение, просто взаимодействуя со страницей
* Утверждения, нажав на одну из иконок на панели инструментов, а затем кликнув на элемент на странице для утверждения. Вы можете выбрать:
  * `'assert visibility'` для утверждения, что элемент видим
  * `'assert text'` для утверждения, что элемент содержит определенный текст
  * `'assert value'` для утверждения, что элемент имеет определенное значение

###### 
![Recording a test](https://github.com/microsoft/playwright/assets/13063165/34a79ea1-639e-4cb3-8115-bfdc78e3d34d)

###### 
Когда вы закончите взаимодействовать со страницей, нажмите кнопку **запись**, чтобы остановить запись, и используйте кнопку **копировать**, чтобы скопировать сгенерированный код в ваш редактор.

Используйте кнопку **очистить**, чтобы очистить код и начать запись заново. После завершения закройте окно Playwright Inspector или остановите команду терминала.

### Генерация локаторов

Вы можете генерировать [локаторы](/locators.mdx) с помощью генератора тестов.
* Нажмите кнопку `'Записать'`, чтобы остановить запись, и кнопка `'Выбрать локатор'` появится.
* Нажмите на кнопку `'Выбрать локатор'`, а затем наведите курсор на элементы в окне браузера, чтобы увидеть локатор, выделенный под каждым элементом.
* Чтобы выбрать локатор, нажмите на элемент, который вы хотите локализовать, и код для этого локатора появится в поле рядом с кнопкой Выбрать локатор.
* Вы можете отредактировать локатор в этом поле, чтобы уточнить его, или использовать кнопку копирования, чтобы скопировать его и вставить в ваш код.

###### 
![picking a locator](https://github.com/microsoft/playwright/assets/13063165/2c8a12e2-4e98-4fdd-af92-1d73ae696d86)

## Эмуляция

Вы можете использовать генератор тестов для генерации тестов с использованием эмуляции, чтобы создать тест для конкретного размера окна, устройства, цветовой схемы, а также эмулировать геолокацию, язык или часовой пояс. Генератор тестов также может генерировать тест, сохраняя состояние аутентификации.

### Эмуляция размера окна

Playwright открывает окно браузера с установленным размером окна на определенную ширину и высоту и не является отзывчивым, так как тесты должны выполняться в одинаковых условиях. Используйте опцию `--viewport`, чтобы генерировать тесты с другим размером окна.

```bash
npx playwright codegen --viewport-size="800,600" playwright.dev
```

###### 
<img width="870" alt="Codegen generating code for tests for playwright.dev website with a specific viewport js" src="https://user-images.githubusercontent.com/13063165/220402029-f90d1c9f-d740-4c0f-acc8-95235ee83f85.png" />

### Эмуляция устройств

Записывайте скрипты и тесты, эмулируя мобильное устройство, используя опцию `--device`, которая устанавливает размер окна и пользовательский агент, среди прочего.

```bash
npx playwright codegen --device="iPhone 13" playwright.dev
```

###### 
<img width="1300" alt="Codegen generating code for tests for playwright.dev website emulated for iPhone 13 js" src="https://user-images.githubusercontent.com/13063165/220921482-dc4f5532-9dce-40bd-8a28-e0d87d26a601.png" />

### Эмуляция цветовой схемы

Записывайте скрипты и тесты, эмулируя цветовую схему с помощью опции `--color-scheme`.

```bash
npx playwright codegen --color-scheme=dark playwright.dev
```

###### 
<img width="1394" alt="Codegen generating code for tests for playwright.dev website in dark mode js" src="https://user-images.githubusercontent.com/13063165/220930273-f3a25bae-64dd-4bbb-99ed-1e97c0cb1ebf.png" />

### Эмуляция геолокации, языка и часового пояса

Записывайте скрипты и тесты, эмулируя часовой пояс, язык и местоположение, используя опции `--timezone`, `--geolocation` и `--lang`. После открытия страницы:
1. Примите куки
1. В правом верхнем углу нажмите кнопку определения местоположения, чтобы увидеть, как работает геолокация.

```bash
npx playwright codegen --timezone="Europe/Rome" --geolocation="41.890221,12.492348" --lang="it-IT" bing.com/maps
```

###### 
<img width="1394" alt="Codegen generating code for tests for bing maps showing timezone, geolocation as Rome, Italy and in Italian language" src="https://user-images.githubusercontent.com/13063165/220931996-d3144421-8d3b-4f9f-896c-769c01566c01.png" />

### Сохранение состояния аутентификации

Запустите `codegen` с `--save-storage`, чтобы сохранить [куки](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies), [localStorage](https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage) и данные [IndexedDB](https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API) в конце сессии. Это полезно для отдельной записи шага аутентификации и повторного использования его позже при записи дополнительных тестов.

```bash
npx playwright codegen github.com/microsoft/playwright --save-storage=auth.json
```

###### 
<img width="1394" alt="github page before logging in js" src="https://user-images.githubusercontent.com/13063165/220929062-88dfe567-0c6d-4e49-b9f9-74ae241fb8c7.png" />

#### Вход в систему

После выполнения аутентификации и закрытия браузера файл `auth.json` будет содержать состояние хранилища, которое вы затем можете повторно использовать в своих тестах.

<img width="1394" alt="login to GitHub screen" src="https://user-images.githubusercontent.com/13063165/220561688-04b2b984-4ba6-4446-8b0a-8058876e2a02.png" />

Убедитесь, что вы используете `auth.json` только локально, так как он содержит конфиденциальную информацию. Добавьте его в ваш `.gitignore` или удалите, как только закончите генерировать тесты.

#### Загрузка состояния аутентификации

Запустите с `--load-storage`, чтобы использовать ранее загруженное хранилище из `auth.json`. Таким образом, все [куки](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies), [localStorage](https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage) и данные [IndexedDB](https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API) будут восстановлены, что позволит большинству веб-приложений перейти в состояние аутентификации без необходимости повторного входа. Это означает, что вы можете продолжать генерировать тесты из состояния входа.

```bash
npx playwright codegen --load-storage=auth.json github.com/microsoft/playwright
```

###### 
<img width="1394" alt="github signed in showing use of load storage js" src="https://user-images.githubusercontent.com/13063165/220927873-9e55fdda-2def-45c1-9a1b-bcc851885f96.png" />

## Запись с использованием пользовательской настройки

Если вы хотите использовать codegen в нестандартной настройке (например, использовать [browserContext.route()](/api/class-browsercontext.mdx#browser-context-route)), вы можете вызвать [page.pause()](/api/class-page.mdx#page-pause), что откроет отдельное окно с элементами управления codegen.

```js
const { chromium } = require('@playwright/test');

(async () => {
  // Убедитесь, что вы запускаете в режиме с графическим интерфейсом.
  const browser = await chromium.launch({ headless: false });

  // Настройте контекст так, как вам нужно.
  const context = await browser.newContext({ /* передайте любые параметры */ });
  await context.route('**/*', route => route.continue());

  // Приостановите страницу и начните запись вручную.
  const page = await context.newPage();
  await page.pause();
})();
```

[Accessibility]: /api/class-accessibility.mdx "Доступность"
[Android]: /api/class-android.mdx "Android"
[AndroidDevice]: /api/class-androiddevice.mdx "AndroidDevice"
[AndroidInput]: /api/class-androidinput.mdx "AndroidInput"
[AndroidSocket]: /api/class-androidsocket.mdx "AndroidSocket"
[AndroidWebView]: /api/class-androidwebview.mdx "AndroidWebView"
[APIRequest]: /api/class-apirequest.mdx "APIRequest"
[APIRequestContext]: /api/class-apirequestcontext.mdx "APIRequestContext"
[APIResponse]: /api/class-apiresponse.mdx "APIResponse"
[APIResponseAssertions]: /api/class-apiresponseassertions.mdx "APIResponseAssertions"
[Browser]: /api/class-browser.mdx "Browser"
[BrowserContext]: /api/class-browsercontext.mdx "BrowserContext"
[BrowserServer]: /api/class-browserserver.mdx "BrowserServer"
[BrowserType]: /api/class-browsertype.mdx "BrowserType"
[CDPSession]: /api/class-cdpsession.mdx "CDPSession"
[Clock]: /api/class-clock.mdx "Clock"
[ConsoleMessage]: /api/class-consolemessage.mdx "ConsoleMessage"
[Coverage]: /api/class-coverage.mdx "Coverage"
[Dialog]: /api/class-dialog.mdx "Dialog"
[Download]: /api/class-download.mdx "Download"
[Electron]: /api/class-electron.mdx "Electron"
[ElectronApplication]: /api/class-electronapplication.mdx "ElectronApplication"
[ElementHandle]: /api/class-elementhandle.mdx "ElementHandle"
[FileChooser]: /api/class-filechooser.mdx "FileChooser"
[Frame]: /api/class-frame.mdx "Frame"
[FrameLocator]: /api/class-framelocator.mdx "FrameLocator"
[GenericAssertions]: /api/class-genericassertions.mdx "GenericAssertions"
[JSHandle]: /api/class-jshandle.mdx "JSHandle"
[Keyboard]: /api/class-keyboard.mdx "Keyboard"
[Locator]: /api/class-locator.mdx "Locator"
[LocatorAssertions]: /api/class-locatorassertions.mdx "LocatorAssertions"
[Logger]: /api/class-logger.mdx "Logger"
[Mouse]: /api/class-mouse.mdx "Mouse"
[Page]: /api/class-page.mdx "Page"
[PageAssertions]: /api/class-pageassertions.mdx "PageAssertions"
[Playwright]: /api/class-playwright.mdx "Playwright"
[PlaywrightAssertions]: /api/class-playwrightassertions.mdx "PlaywrightAssertions"
[Request]: /api/class-request.mdx "Request"
[Response]: /api/class-response.mdx "Response"
[Route]: /api/class-route.mdx "Route"
[Selectors]: /api/class-selectors.mdx "Selectors"
[SnapshotAssertions]: /api/class-snapshotassertions.mdx "SnapshotAssertions"
[TimeoutError]: /api/class-timeouterror.mdx "TimeoutError"
[Touchscreen]: /api/class-touchscreen.mdx "Touchscreen"
[Tracing]: /api/class-tracing.mdx "Tracing"
[Video]: /api/class-video.mdx "Video"
[WebError]: /api/class-weberror.mdx "WebError"
[WebSocket]: /api/class-websocket.mdx "WebSocket"
[WebSocketRoute]: /api/class-websocketroute.mdx "WebSocketRoute"
[Worker]: /api/class-worker.mdx "Worker"
[Fixtures]: /api/class-fixtures.mdx "Fixtures"
[FullConfig]: /api/class-fullconfig.mdx "FullConfig"
[FullProject]: /api/class-fullproject.mdx "FullProject"
[Location]: /api/class-location.mdx "Location"
[Test]: /api/class-test.mdx "Test"
[TestConfig]: /api/class-testconfig.mdx "TestConfig"
[TestInfo]: /api/class-testinfo.mdx "TestInfo"
[TestInfoError]: /api/class-testinfoerror.mdx "TestInfoError"
[TestOptions]: /api/class-testoptions.mdx "TestOptions"
[TestProject]: /api/class-testproject.mdx "TestProject"
[TestStepInfo]: /api/class-teststepinfo.mdx "TestStepInfo"
[WorkerInfo]: /api/class-workerinfo.mdx "WorkerInfo"
[Reporter]: /api/class-reporter.mdx "Reporter"
[Suite]: /api/class-suite.mdx "Suite"
[TestCase]: /api/class-testcase.mdx "TestCase"
[TestError]: /api/class-testerror.mdx "TestError"
[TestResult]: /api/class-testresult.mdx "TestResult"
[TestStep]: /api/class-teststep.mdx "TestStep"
[Element]: https://developer.mozilla.org/en-US/docs/Web/API/element "Элемент"
[EvaluationArgument]: /evaluating.mdx#evaluation-argument "EvaluationArgument"
[Promise]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise "Promise"
[iterator]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols "Итератор"
[origin]: https://developer.mozilla.org/en-US/docs/Glossary/Origin "Происхождение"
[selector]: https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors "селектор"
[Serializable]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify#Description "Сериализуемый"
[UIEvent.detail]: https://developer.mozilla.org/en-US/docs/Web/API/UIEvent/detail "UIEvent.detail"
[UnixTime]: https://en.wikipedia.org/wiki/Unix_time "Unix Time"
[xpath]: https://developer.mozilla.org/en-US/docs/Web/XPath "xpath"

[Array]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array "Массив"
[boolean]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type "Логический"
[Buffer]: https://nodejs.org/api/buffer.html#buffer_class_buffer "Буфер"
[ChildProcess]: https://nodejs.org/api/child_process.html "Дочерний процесс"
[Date]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date "Дата"
[Error]: https://nodejs.org/api/errors.html#errors_class_error "Ошибка"
[EventEmitter]: https://nodejs.org/api/events.html#events_class_eventemitter "EventEmitter"
[function]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function "Функция"
[FormData]: https://developer.mozilla.org/en-US/docs/Web/API/FormData "FormData"
[Map]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map "Карта"
[Metadata]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object "Object&lt;string, any&gt;"
[null]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/null "null"
[number]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type "Число"
[Object]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object "Объект"
[Promise]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise "Promise"
[Readable]: https://nodejs.org/api/stream.html#stream_class_stream_readable "Readable"
[ReadStream]: https://nodejs.org/api/fs.html#class-fsreadstream "ReadStream"
[RegExp]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp "Регулярное выражение"
[string]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type "строка"
[void]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined "void"
[URL]: https://nodejs.org/api/url.html "URL"
[URLSearchParams]: https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams "URLSearchParams"