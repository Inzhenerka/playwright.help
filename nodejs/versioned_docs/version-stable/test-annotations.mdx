---
id: test-annotations
title: "Аннотации"
---
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import HTMLCard from '@site/src/components/HTMLCard';

## Введение

Playwright поддерживает теги и аннотации, которые отображаются в отчете о тестировании.

Вы можете добавлять свои собственные теги и аннотации в любой момент, но Playwright поставляется с несколькими встроенными:
- [test.skip()](/api/class-test.mdx#test-skip) помечает тест как неактуальный. Playwright не выполняет такой тест. Используйте эту аннотацию, когда тест не применим в какой-либо конфигурации.
- [test.fail()](/api/class-test.mdx#test-fail) помечает тест как провалившийся. Playwright выполнит этот тест и убедится, что он действительно проваливается. Если тест не проваливается, Playwright выдаст предупреждение.
- [test.fixme()](/api/class-test.mdx#test-fixme) помечает тест как провалившийся. В отличие от аннотации `fail`, Playwright не будет выполнять этот тест. Используйте `fixme`, когда выполнение теста медленное или вызывает сбой.
- [test.slow()](/api/class-test.mdx#test-slow) помечает тест как медленный и утрачивает время ожидания теста в три раза.

Аннотации могут быть добавлены к одному тесту или группе тестов.

Встроенные аннотации могут быть условными, в этом случае они применяются, когда условие истинно, и могут зависеть от тестовых фикстур. На одном и том же тесте может быть несколько аннотаций, возможно, в разных конфигурациях.

## Сфокусировать тест

Вы можете сфокусировать некоторые тесты. Когда есть сфокусированные тесты, выполняются только эти тесты.

```js
test.only('сфокусировать этот тест', async ({ page }) => {
  // Выполнять только сфокусированные тесты во всем проекте.
});
```

## Пропустить тест

Пометьте тест как пропущенный.

```js
test.skip('пропустить этот тест', async ({ page }) => {
  // Этот тест не выполняется
});
```

## Условно пропустить тест

Вы можете пропустить определенный тест на основе условия.

```js
test('пропустить этот тест', async ({ page, browserName }) => {
  test.skip(browserName === 'firefox', 'Все еще работаем над этим');
});
```

## Группировка тестов

Вы можете группировать тесты, чтобы дать им логическое имя или ограничить хуки before/after для группы.

```js
import { test, expect } from '@playwright/test';

test.describe('две теста', () => {
  test('один', async ({ page }) => {
    // ...
  });

  test('два', async ({ page }) => {
    // ...
  });
});
```

## Тегирование тестов

Иногда вы хотите пометить свои тесты как `@fast` или `@slow`, а затем фильтровать по тегу в отчете о тестировании. Или вы можете захотеть выполнять только тесты, которые имеют определенный тег.

Чтобы пометить тест, либо предоставьте дополнительный объект деталей при объявлении теста, либо добавьте токен `@` к заголовку теста. Обратите внимание, что теги должны начинаться с символа `@`.

```js
import { test, expect } from '@playwright/test';

test('тест страницы входа', {
  tag: '@fast',
}, async ({ page }) => {
  // ...
});

test('тест полного отчета @slow', async ({ page }) => {
  // ...
});
```

Вы также можете пометить все тесты в группе или предоставить несколько тегов:

```js
import { test, expect } from '@playwright/test';

test.describe('группа', {
  tag: '@report',
}, () => {
  test('тест заголовка отчета', async ({ page }) => {
    // ...
  });

  test('тест полного отчета', {
    tag: ['@slow', '@vrt'],
  }, async ({ page }) => {
    // ...
  });
});
```

Теперь вы можете запускать тесты, которые имеют определенный тег, с помощью опции командной строки [`--grep`](./test-cli.mdx#reference).

<Tabs
  groupId="bash-flavor"
  defaultValue="bash"
  values={[
    {label: 'Bash', value: 'bash'},
    {label: 'PowerShell', value: 'powershell'},
    {label: 'Batch', value: 'batch'}
  ]
}>
<TabItem value="bash">

```bash
npx playwright test --grep @fast
```

</TabItem>
<TabItem value="powershell">

```powershell
npx playwright test --grep "@fast"
```

</TabItem>
<TabItem value="batch">

```batch
npx playwright test --grep @fast
```

</TabItem>
</Tabs>

Или, если вы хотите противоположное, вы можете пропустить тесты с определенным тегом:

<Tabs
  groupId="bash-flavor"
  defaultValue="bash"
  values={[
    {label: 'Bash', value: 'bash'},
    {label: 'PowerShell', value: 'powershell'},
    {label: 'Batch', value: 'batch'}
  ]
}>
<TabItem value="bash">

```bash
npx playwright test --grep-invert @fast
```

</TabItem>
<TabItem value="powershell">

```powershell
npx playwright test --grep-invert "@fast"
```

</TabItem>
<TabItem value="batch">

```batch
npx playwright test --grep-invert @fast
```

</TabItem>
</Tabs>

Чтобы запустить тесты, содержащие любой тег (логический оператор `OR`):

<Tabs
  groupId="bash-flavor"
  defaultValue="bash"
  values={[
    {label: 'Bash', value: 'bash'},
    {label: 'PowerShell', value: 'powershell'},
    {label: 'Batch', value: 'batch'}
  ]
}>
<TabItem value="bash">

```bash
npx playwright test --grep "@fast|@slow"
```

</TabItem>
<TabItem value="powershell">

```powershell
npx playwright test --grep --% "@fast^|@slow"
```

</TabItem>
<TabItem value="batch">

```batch
npx playwright test --grep "@fast^|@slow"
```

</TabItem>
</Tabs>

Или запустите тесты, содержащие оба тега (логический оператор `AND`), используя регулярные выражения:

```bash
npx playwright test --grep "(?=.*@fast)(?=.*@slow)"
```

Вы также можете фильтровать тесты в конфигурационном файле через [testConfig.grep](/api/class-testconfig.mdx#test-config-grep) и [testProject.grep](/api/class-testproject.mdx#test-project-grep).

## Аннотирование тестов

Если вы хотите аннотировать свои тесты чем-то более значительным, чем тег, вы можете сделать это при объявлении теста. Аннотации имеют `type` и `description` для дополнительного контекста и доступны в API репортера. Встроенный HTML-репортер Playwright показывает все аннотации, кроме тех, где `type` начинается с символа `_`.

Например, чтобы аннотировать тест с URL проблемы:

```js
import { test, expect } from '@playwright/test';

test('тест страницы входа', {
  annotation: {
    type: 'issue',
    description: 'https://github.com/microsoft/playwright/issues/23180',
  },
}, async ({ page }) => {
  // ...
});
```

Вы также можете аннотировать все тесты в группе или предоставить несколько аннотаций:

```js
import { test, expect } from '@playwright/test';

test.describe('тесты отчета', {
  annotation: { type: 'category', description: 'отчет' },
}, () => {
  test('тест заголовка отчета', async ({ page }) => {
    // ...
  });

  test('тест полного отчета', {
    annotation: [
      { type: 'issue', description: 'https://github.com/microsoft/playwright/issues/23180' },
      { type: 'performance', description: 'очень медленный тест!' },
    ],
  }, async ({ page }) => {
    // ...
  });
});
```

## Условно пропустить группу тестов

Например, вы можете запустить группу тестов только в Chromium, передав обратный вызов.

```js title="example.spec.ts"

test.describe('только для chromium', () => {
  test.skip(({ browserName }) => browserName !== 'chromium', 'Только для Chromium!');

  test.beforeAll(async () => {
    // Этот хук выполняется только в Chromium.
  });

  test('тест 1', async ({ page }) => {
    // Этот тест выполняется только в Chromium.
  });

  test('тест 2', async ({ page }) => {
    // Этот тест выполняется только в Chromium.
  });
});
```

## Используйте fixme в хуке `beforeEach`

Чтобы избежать выполнения хуков `beforeEach`, вы можете поместить аннотации в сам хук.

```js title="example.spec.ts"

test.beforeEach(async ({ page, isMobile }) => {
  test.fixme(isMobile, 'Страница настроек пока не работает на мобильных устройствах');

  await page.goto('http://localhost:3000/settings');
});

test('профиль пользователя', async ({ page }) => {
  await page.getByText('Мой профиль').click();
  // ...
});
```

## Аннотации во время выполнения

Во время выполнения теста вы можете добавлять аннотации в [`test.info().annotations`](./api/class-testinfo#test-info-annotations).

```js title="example.spec.ts"

test('пример теста', async ({ page, browser }) => {
  test.info().annotations.push({
    type: 'версия браузера',
    description: browser.version(),
  });

  // ...
});
```