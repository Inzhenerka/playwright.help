---
id: navigations
title: "Навигации"
---
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import HTMLCard from '@site/src/components/HTMLCard';

## Введение

Playwright может переходить по URL и обрабатывать навигации, вызванные взаимодействиями со страницей.

## Основная навигация

Самая простая форма навигации — это открытие URL:

```js
// Переход на страницу
await page.goto('https://example.com');
```

Код выше загружает страницу и ждет, пока веб-страница не сгенерирует событие [load](https://developer.mozilla.org/en-US/docs/Web/API/Window/load_event). Событие загрузки срабатывает, когда вся страница загружена, включая все зависимые ресурсы, такие как таблицы стилей, скрипты, iframe и изображения.

:::note

Если страница выполняет перенаправление на стороне клиента до события `load`, [page.goto()](/api/class-page.mdx#page-goto) будет ждать, пока перенаправленная страница не сгенерирует событие `load`.
:::

## Когда страница загружена?

Современные страницы выполняют множество действий после срабатывания события `load`. Они загружают данные лениво, заполняют пользовательский интерфейс, загружают ресурсы, скрипты и стили после срабатывания события `load`. Невозможно точно определить, что страница "загружена", это зависит от страницы, фреймворка и т.д. Так когда можно начинать взаимодействовать с ней?

В Playwright вы можете взаимодействовать со страницей в любой момент. Он автоматически будет ждать, пока целевые элементы не станут [доступными для действий](./actionability.mdx).

```js
// Переход и клик по элементу
// Клик будет автоматически ждать элемент
await page.goto('https://example.com');
await page.getByText('Example Domain').click();
```

В приведенном выше сценарии Playwright будет ждать, пока текст не станет видимым, дождется выполнения остальных проверок доступности для этого элемента и кликнет по нему.

Playwright работает как очень быстрый пользователь — в момент, когда он видит кнопку, он нажимает на нее. В общем случае вам не нужно беспокоиться о том, загрузились ли все ресурсы и т.д.

## Гидратация

В какой-то момент вы столкнетесь с ситуацией, когда Playwright выполняет действие, но ничего, казалось бы, не происходит. Или вы вводите текст в поле ввода, и он исчезает. Наиболее вероятная причина этого — плохая [гидратация](https://en.wikipedia.org/wiki/Hydration_(web_development)) страницы.

Когда страница гидратируется, сначала статическая версия страницы отправляется в браузер. Затем отправляется динамическая часть, и страница становится "живой". Как очень быстрый пользователь, Playwright начнет взаимодействовать со страницей в момент, когда увидит ее. И если кнопка на странице активна, но слушатели еще не добавлены, Playwright выполнит свою работу, но клик не окажет никакого эффекта.

Простой способ проверить, страдает ли ваша страница от плохой гидратации, — открыть Chrome DevTools, выбрать эмуляцию сети "Slow 3G" в панели Сеть и перезагрузить страницу. Как только вы увидите интересующий элемент, взаимодействуйте с ним. Вы увидите, что клики по кнопке будут проигнорированы, а введенный текст будет сброшен последующим кодом загрузки страницы. Правильное решение этой проблемы — убедиться, что все интерактивные элементы отключены до завершения гидратации, когда страница полностью функциональна.

## Ожидание навигации

Клик по элементу может вызвать несколько навигаций. В таких случаях рекомендуется явно использовать [page.waitForURL()](/api/class-page.mdx#page-wait-for-url) для конкретного URL.

```js
await page.getByText('Click me').click();
await page.waitForURL('**/login');
```

## События навигации

Playwright разделяет процесс отображения нового документа на странице на **навигацию** и **загрузку**.

**Навигация начинается** с изменения URL страницы или взаимодействия со страницей (например, клик по ссылке). Намерение навигации может быть отменено, например, при попытке обратиться к неразрешенному DNS-адресу или преобразовано в загрузку файла.

**Навигация завершается** после того, как заголовки ответа были обработаны и история сессии обновлена. Только после успешного завершения навигации (ее фиксации) страница начинает **загрузку** документа.

**Загрузка** охватывает получение оставшейся части тела ответа по сети, парсинг, выполнение скриптов и срабатывание событий загрузки:
- [page.url()](/api/class-page.mdx#page-url) устанавливается на новый URL
- содержимое документа загружается по сети и парсится
- срабатывает событие [page.on('domcontentloaded')](/api/class-page.mdx#page-event-dom-content-loaded)
- страница выполняет некоторые скрипты и загружает ресурсы, такие как таблицы стилей и изображения
- срабатывает событие [page.on('load')](/api/class-page.mdx#page-event-load)
- страница выполняет динамически загруженные скрипты